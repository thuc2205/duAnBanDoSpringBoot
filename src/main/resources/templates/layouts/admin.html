<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <link
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            rel="stylesheet"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            crossorigin="anonymous"
    />
    <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css"
    />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <style>
        body {
            margin-top: 20px;
            background: #fafafa;
        }
        .order-card {
            color: #fff;
        }

        .bg-c-blue {
            background: linear-gradient(45deg, #4099ff, #73b4ff);
        }

        .bg-c-green {
            background: linear-gradient(45deg, #2ed8b6, #59e0c5);
        }

        .bg-c-yellow {
            background: linear-gradient(45deg, #ffb64d, #ffcb80);
        }

        .bg-c-pink {
            background: linear-gradient(45deg, #ff5370, #ff869a);
        }

        .card {
            border-radius: 5px;
            -webkit-box-shadow: 0 1px 2.94px 0.06px rgba(4, 26, 55, 0.16);
            box-shadow: 0 1px 2.94px 0.06px rgba(4, 26, 55, 0.16);
            border: none;
            margin-bottom: 30px;
            -webkit-transition: all 0.3s ease-in-out;
            transition: all 0.3s ease-in-out;
        }

        .card .card-block {
            padding: 25px;
        }

        .order-card i {
            font-size: 26px;
        }

        .f-left {
            float: left;
        }

        .f-right {
            float: right;
        }
    </style>
</head>
<body>
<header class="navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0 shadow">
    <a class="navbar-brand col-md-3 col-lg-2 me-0 px-3" href="#">BATHUCBANHANGCAM</a>
    <button class="navbar-toggler position-absolute d-md-none collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>
    <input class="form-control form-control-dark w-100" type="text" placeholder="Search" aria-label="Search" />
    <div class="navbar-nav">
        <div class="nav-item text-nowrap">
            <span id="phoneNumber" style="color: white"></span>
            <a class="nav-link px-3" th:href="@{/api/thuc/us/logout}">Sign out</a>
        </div>
    </div>
</header>

<div class="container-fluid">
    <div class="row">
        <nav id="sidebarMenu" class="col-md-3 col-lg-2 d-md-block bg-light sidebar collapse">
            <div class="position-sticky pt-3">
                <ul class="nav flex-column">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/layout/product}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-home" aria-hidden="true">
                                <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path>
                                <polyline points="9 22 9 12 15 12 15 22"></polyline>
                            </svg>
                            Danh Sách Sản Phẩm
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/layout/color}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-apple" viewBox="0 0 16 16">
                                <path d="M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516s1.52.087 2.475-1.258.762-2.391.728-2.43m3.314 11.733c-.048-.096-2.325-1.234-2.113-3.422s1.675-2.789 1.698-2.854-.597-.79-1.254-1.157a3.7 3.7 0 0 0-1.563-.434c-.108-.003-.483-.095-1.254.116-.508.139-1.653.589-1.968.607-.316.018-1.256-.522-2.267-.665-.647-.125-1.333.131-1.824.328-.49.196-1.422.754-2.074 2.237-.652 1.482-.311 3.83-.067 4.56s.625 1.924 1.273 2.796c.576.984 1.34 1.667 1.659 1.899s1.219.386 1.843.067c.502-.308 1.408-.485 1.766-.472.357.013 1.061.154 1.782.539.571.197 1.111.115 1.652-.105.541-.221 1.324-1.059 2.238-2.758q.52-1.185.473-1.282"/>
                                <path d="M11.182.008C11.148-.03 9.923.023 8.857 1.18c-1.066 1.156-.902 2.482-.878 2.516s1.52.087 2.475-1.258.762-2.391.728-2.43m3.314 11.733c-.048-.096-2.325-1.234-2.113-3.422s1.675-2.789 1.698-2.854-.597-.79-1.254-1.157a3.7 3.7 0 0 0-1.563-.434c-.108-.003-.483-.095-1.254.116-.508.139-1.653.589-1.968.607-.316.018-1.256-.522-2.267-.665-.647-.125-1.333.131-1.824.328-.49.196-1.422.754-2.074 2.237-.652 1.482-.311 3.83-.067 4.56s.625 1.924 1.273 2.796c.576.984 1.34 1.667 1.659 1.899s1.219.386 1.843.067c.502-.308 1.408-.485 1.766-.472.357.013 1.061.154 1.782.539.571.197 1.111.115 1.652-.105.541-.221 1.324-1.059 2.238-2.758q.52-1.185.473-1.282"/>
                            </svg>
                            Color
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/layout/brand}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bank" viewBox="0 0 16 16">
                                <path d="m8 0 6.61 3h.89a.5.5 0 0 1 .5.5v2a.5.5 0 0 1-.5.5H15v7a.5.5 0 0 1 .485.38l.5 2a.498.498 0 0 1-.485.62H.5a.498.498 0 0 1-.485-.62l.5-2A.5.5 0 0 1 1 13V6H.5a.5.5 0 0 1-.5-.5v-2A.5.5 0 0 1 .5 3h.89zM3.777 3h8.447L8 1zM2 6v7h1V6zm2 0v7h2.5V6zm3.5 0v7h1V6zm2 0v7H12V6zM13 6v7h1V6zm2-1V4H1v1zm-.39 9H1.39l-.25 1h13.72z"/>
                            </svg>
                             Brand
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/layout/xuatxu}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-bicycle" viewBox="0 0 16 16">
                                <path d="M4 4.5a.5.5 0 0 1 .5-.5H6a.5.5 0 0 1 0 1v.5h4.14l.386-1.158A.5.5 0 0 1 11 4h1a.5.5 0 0 1 0 1h-.64l-.311.935.807 1.29a3 3 0 1 1-.848.53l-.508-.812-2.076 3.322A.5.5 0 0 1 8 10.5H5.959a3 3 0 1 1-1.815-3.274L5 5.856V5h-.5a.5.5 0 0 1-.5-.5m1.5 2.443-.508.814c.5.444.85 1.054.967 1.743h1.139zM8 9.057 9.598 6.5H6.402zM4.937 9.5a2 2 0 0 0-.487-.877l-.548.877zM3.603 8.092A2 2 0 1 0 4.937 10.5H3a.5.5 0 0 1-.424-.765zm7.947.53a2 2 0 1 0 .848-.53l1.026 1.643a.5.5 0 1 1-.848.53z"/>
                            </svg>
                               Xuất xứ
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/layout/size}"  style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-browser-chrome" viewBox="0 0 16 16">
                                <path fill-rule="evenodd" d="M16 8a8 8 0 0 1-7.022 7.94l1.902-7.098a3 3 0 0 0 .05-1.492A3 3 0 0 0 10.237 6h5.511A8 8 0 0 1 16 8M0 8a8 8 0 0 0 7.927 8l1.426-5.321a3 3 0 0 1-.723.255 3 3 0 0 1-1.743-.147 3 3 0 0 1-1.043-.7L.633 4.876A8 8 0 0 0 0 8m5.004-.167L1.108 3.936A8.003 8.003 0 0 1 15.418 5H8.066a3 3 0 0 0-1.252.243 2.99 2.99 0 0 0-1.81 2.59M8 10a2 2 0 1 0 0-4 2 2 0 0 0 0 4"/>
                            </svg>
                            Size
                        </a>
                    </li>
                    <!-- other list items -->
                </ul>

                <h6 class="sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted">
                    <!-- <span>Saved reports</span> -->
                    <a class="link-secondary" href="#" aria-label="Add a new report">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-plus-circle" aria-hidden="true">
                            <circle cx="12" cy="12" r="10"></circle>
                            <line x1="12" y1="8" x2="12" y2="16"></line>
                            <line x1="8" y1="12" x2="16" y2="12"></line>
                        </svg>
                    </a>
                </h6>
                <ul class="nav flex-column mb-2">
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/layout/donhang}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-1-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M9.283 4.002H7.971L6.072 5.385v1.271l1.834-1.318h.065V12h1.312z"/>
                            </svg>
                            Quản Lí Đơn Hàng
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item">
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/size/list}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-2-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M6.646 6.24c0-.691.493-1.306 1.336-1.306.756 0 1.313.492 1.313 1.236 0 .697-.469 1.23-.902 1.705l-2.971 3.293V12h5.344v-1.107H7.268v-.077l1.974-2.22.096-.107c.688-.763 1.287-1.428 1.287-2.43 0-1.266-1.031-2.215-2.613-2.215-1.758 0-2.637 1.19-2.637 2.402v.065h1.271v-.07Z"/>
                            </svg>
                            Quản Lí Hóa Đơn
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item" >
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/size/list}"style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-3-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-8.082.414c.92 0 1.535.54 1.541 1.318.012.791-.615 1.36-1.588 1.354-.861-.006-1.482-.469-1.54-1.066H5.104c.047 1.177 1.05 2.144 2.754 2.144 1.653 0 2.954-.937 2.93-2.396-.023-1.278-1.031-1.846-1.734-1.916v-.07c.597-.1 1.505-.739 1.482-1.876-.03-1.177-1.043-2.074-2.637-2.062-1.675.006-2.59.984-2.625 2.12h1.248c.036-.556.557-1.054 1.348-1.054.785 0 1.348.486 1.348 1.195.006.715-.563 1.237-1.342 1.237h-.838v1.072h.879Z"/>
                            </svg>
                            VouCher
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item" >
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/size/list}" style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-4-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M7.519 5.057c-.886 1.418-1.772 2.838-2.542 4.265v1.12H8.85V12h1.26v-1.559h1.007V9.334H10.11V4.002H8.176zM6.225 9.281v.053H8.85V5.063h-.065c-.867 1.33-1.787 2.806-2.56 4.218"/>
                            </svg>
                            Thống Kê
                        </a>
                    </li>
                    <!-- other list items -->
                    <li class="nav-item" >
                        <a class="nav-link active" aria-current="page" th:href="@{/api/thuc/size/list}"style="color: black">
                            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-5-circle-fill" viewBox="0 0 16 16">
                                <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0m-8.006 4.158c1.74 0 2.924-1.119 2.924-2.806 0-1.641-1.178-2.584-2.56-2.584-.897 0-1.442.421-1.612.68h-.064l.193-2.344h3.621V4.002H5.791L5.445 8.63h1.149c.193-.358.668-.809 1.435-.809.85 0 1.582.604 1.582 1.57 0 1.085-.779 1.682-1.57 1.682-.697 0-1.389-.31-1.53-1.031H5.276c.065 1.213 1.149 2.115 2.72 2.115Z"/>
                            </svg>
                            Bán Hàng Tại Quầy
                        </a>
                    </li>
                    <!-- other list items -->
                </ul>
            </div>
        </nav>

        <main class="col-md-9 ms-sm-auto col-lg-10 px-md-4">
            <div class="chartjs-size-monitor">
                <div class="chartjs-size-monitor-expand"><div class=""></div></div>
                <div class="chartjs-size-monitor-shrink"><div class=""></div></div>
            </div>
            <div class="d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom">
                <!-- bắt đầu  -->
                <div class="container">
                    <!-- content -->
                    <section>
                        <div layout:fragment="content"></div>
                    </section>

                </div>
                <!-- end -->
            </div>
        </main>
    </div>
</div>


<script>
    function updateOrderStatus(id) {
        const newStatus = 'Đang Chuẩn Bị'; // Set the new status here

        // Hộp thoại xác nhận
        const confirmUpdate = confirm('Bạn có muốn cập nhật trạng thái đơn hàng không?');
        if (!confirmUpdate) {
            return; // Không làm gì nếu người dùng không đồng ý
        }

        // Gửi yêu cầu cập nhật đến server
        fetch(`/api/thuc/order/orderdetail/${id}?status=${encodeURIComponent(newStatus)}`, {
            method: 'PUT',
            headers: {
                'Content-Type': 'application/json'
            }
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                console.log('Updated order:', data);
                alert('Đã cập nhật trạng thái đơn hàng thành công!');
                // Optionally, update the UI or perform other actions after successful update
            })
            .catch(error => {
                console.error('Error updating order:', error);
                alert('Đã xảy ra lỗi trong quá trình cập nhật đơn hàng. Vui lòng thử lại sau!');
            });
    }
</script>

<script>
    // Danh sách các cặp sizeId và colorId
    var listSizeColors = [];

    // Hàm thêm size và màu vào danh sách
    function addSizeColor() {
        var sizeSelect = document.getElementById("size_id");
        var colorSelect = document.getElementById("color_id");

        var sizeId = sizeSelect.value;
        var colorId = colorSelect.value;

        // Thêm cặp sizeId và colorId vào danh sách
        listSizeColors.push({sizeId: sizeId, colorId: colorId});

        // Hiển thị thông tin đã chọn cho người dùng
        var sizeName = sizeSelect.options[sizeSelect.selectedIndex].text;
        var colorName = colorSelect.options[colorSelect.selectedIndex].text;
        var sizeColorDiv = document.createElement("div");
        sizeColorDiv.innerHTML = "<p>" + colorName + " - " + sizeName + "</p>";
        document.getElementById("sizeColorSelections").appendChild(sizeColorDiv);

        // Ẩn modal
        $('#sizeColorModal').modal('hide');
    }

    // Hàm cập nhật form trước khi gửi
    function updateFormBeforeSubmit() {
        // Tạo một hidden input chứa dữ liệu từ listSizeColors
        var listSizeColorsInput = document.createElement("input");
        listSizeColorsInput.type = "hidden";
        listSizeColorsInput.name = "listSizeColors";

        // Gán giá trị JSON của listSizeColors vào hidden input
        listSizeColorsInput.value = JSON.stringify(listSizeColors);

        // Thêm hidden input vào form
        document.getElementById("productForm").appendChild(listSizeColorsInput);
    }

</script>
<script>
    document.addEventListener("DOMContentLoaded", function() {
        var phoneNumber = document.cookie.replace(/(?:(?:^|.*;\s*)phoneNumber\s*\=\s*([^;]*).*$)|^.*$/, "$1");
        if (phoneNumber) {
            var phoneNumberSpan = document.getElementById("phoneNumber");
            if (phoneNumberSpan) {
                phoneNumberSpan.innerText = phoneNumber;
            }
        }
    });

</script>
<!--cua color-->
<script>
        document.getElementById('colorForm').addEventListener('submit', async (event) => {
        event.preventDefault();

        if (!confirm("Bạn có chắc muốn thêm sản phẩm này?")) {
        return;
    }

        const name = document.getElementById('name').value;
        const token = getCookie('token');

        console.log('Token:', token); // Log token để kiểm tra

        if (!token) {
        alert('Không tìm thấy token');
        return;
    }

        try {
        const response = await fetch(`/api/thuc/color`, {
        method: 'POST',
        headers: {
        'Content-Type': 'application/json',
        'Authorization': 'Bearer ' + token
    },
        body: JSON.stringify({ name: name })
    });

        console.log('Response status:', response.status); // Log trạng thái phản hồi

        if (response.ok) {
        alert('Thành công tạo màu');
        window.location.reload();
    } else {
        const errorData = await response.json();
        alert('Thất bại khi tạo màu: ' + errorData.message);
    }
    } catch (error) {
        console.error('Lỗi:', error);
        alert('Đã xảy ra lỗi khi cố gắng tạo màu.');
    }
    });



        function getCookie(name) {
        let cookieArr = document.cookie.split(";");
        for (let i = 0; i < cookieArr.length; i++) {
        let cookiePair = cookieArr[i].split("=");
        if (name === cookiePair[0].trim()) {
        return decodeURIComponent(cookiePair[1]);
    }
    }
        return null;
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/feather-icons@4.28.0/dist/feather.min.js" integrity="sha384-uO3SXW5IuS1ZpFPKugNNWqTZRRglnUJK6UAZ/gxOX80nxEkN9NcGZTftn6RzhGWE" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js" integrity="sha384-zNy6FEbO50N+Cg5wap8IKA4M/ZnLJgzc6w2NqACZaK0u0FXfOWRRJOnQtpZun8ha" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>
